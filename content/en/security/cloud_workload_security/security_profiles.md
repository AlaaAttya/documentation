---
title: CWS Workload Security Profiles
kind: documentation
further_reading:
  - link: "/security/cloud_workload_security/getting_started"
    tag: "Documentation"
    text: "Setting Up CWS"
---

Workload Security Profiles provide a baseline of expected workload activity via a behavioral learning model that helps identify potential threats or misconfigurations. This insight can be used when investigating security alerts, including [generating suppression suggestions](#suppress-signals-based-on-suggestions) for known, acceptable workload behavior, as well as identifying previously unseen, anomalous behavior.

## Compatibility

For Workload Security Profiles to be compatible with your Datadog configuration, you must have [CWS enabled][1], use Datadog Agent 7.44 or later, and have activity dumps enabled. Workload Security Profiles are enabled by default and support containerized workloads only.

## How Workload Security Profiles are generated

Workload Security Profiles are generated when [activity snapshots](#activity-snapshots) from containers sharing a common image name and image tag (version) are merged together to form a security profile. A different security profile is generated for each version of a container image. As a result, one profile is generated per `{ image-name, image-version}` tag combination.

Each security profile acts as a [behavior model](#behavior-learning-model) for a given workload image to identify known, acceptable behavior that is expected to be consistent across all containers versus previously unseen, anomalous behavior that may be unique to a single container or small number of containers.

The following diagram shows a high-level representation of how activity snapshots from multiple containers are merged into a single Workload Security Profile. The commonality score represents how likely a given process or file activity is normal, known behavior.

**PLACEHOLDER FOR DIAGRAM**

### Activity snapshots

Activity snapshots are the building blocks of Workload Security Profiles. They provide a reasonably accurate representation of expected workload behavior. Each snapshot captures kernel-level activity on a container, including process, network, and file access details. This information is collected by the Agent in 30 minute intervals and sent to the Datadog backend.

When you configure the Agent and enable activity dumps, it automatically starts capturing snapshots for any running cgroups, including those already running when you start the Agent. It also captures snapshots for any new containers in your cloud native environments that use the Linux kernel control groups or cgroups. 

Each Agent can profile multiple containers on the host system simultaneously. To minimize performance overhead, no more than five containers are profiled at any given time.

### Behavior learning model

A Workload Security Profile is a behavior model for a specific workload image. Capturing and comparing activity snapshots from individual containers enables each security profile to provide a model of the aggregate workload behavior of similar containers. This representation results in a more precise behavior model for a specific workload as more containers are profiled. Since containerized workloads are expected to be immutable, there should be few variations between workloads that share common image name and image version tags.

A visual representation of the behavior model, including process nodes and file and network activity relationships is shown on the security profile details page. The [profile visualization](#explore-security-profiles) displays how consistent or common these relationships are across the various containers that have been profiled.

#### Model status

While initial snapshots are being captured and merged into the Workload Security Profile, the profile will be shown with a status of **learning**. After a threshold has been reached in terms of the number of activity snapshots merged or amount of time elapsed since the first snapshot, the security profile status will transition to a **stable** state.

## Explore security profiles

Security profiles generated by CWS are displayed on the [Security Profiles][2] page, grouped by image name. Click an image name to see the full list of security profiles associated with the image. Details shown for each security profile include the number of activity dumps that were merged to create the profile, the status of the behavior learning model, and the date on which the profile was last updated.

{{< img src="security/cws/security_profiles/security-profiles-overview.png" alt="CWS Security Profiles page with auto-generated security profiles" width="100%">}}

Select a security profile to view its details page. Explore the processes that make up the security profile, view related security signals, containers tagged with the image name, and the activity dumps that were used to create the profile.

### Commonality score

The **Behavior Commonality** score at the top of the page shows how common the activity is across all workload instances monitored. In general, the higher the commonality score, the more likely that a given process or file activity is normal, known behavior. Scores may fluctuate over time as more workloads are merged into the profile, or the composition of the individual workloads change over time.

{{< img src="security/cws/security_profiles/security-profile.png" alt="CWS security profile details page" width="100%">}}

Select a process node to view additional details on the side panel. This includes a commonality score for the process based on how common the files and requests in the process activity are across all workload instances monitored.

Security profile details also appear in the signal panel in the [Security Signals Explorer][3]. You can use this information to help distinguish between potential threats and normal workload behavior. If the security profile matches known workload behavior, a [suppression suggestion](#suppress-signals-based-on-suggestions) is displayed.

{{< img src="security/cws/security_profiles/signal-security-profile.png" alt="Cloud Workload Security security profile page" width="80%">}}

### Suppress signals based on suggestions

If a signal matches known workload behavior for a security profile, a suppression suggestion is displayed on the security signal side panel. You can view the corresponding security profile and the process triggering the signal before choosing whether to accept the suggestion.

To accept the suggestion, click **Suppress Signals**, then click **Add Suppression to Rule**. This creates a suppression query for the rule that excludes the process from triggering future security signals.

{{< img src="security/cws/security_profiles/suppression-suggestion.png" alt="The security signal panel showing a suppression suggestion" width="80%">}}

## Further Reading

{{< partial name="whats-next/whats-next.html" >}}

[1]: /security/cloud_workload_security/setup
[2]: https://app.datadoghq.com/security/workload/profiles
[3]: /security/explorer
[4]: /security/cloud_workload_security/getting_started