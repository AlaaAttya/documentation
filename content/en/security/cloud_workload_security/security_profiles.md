---
title: CWS Workload Security Profiles
kind: documentation
further_reading:
  - link: "/security/cloud_workload_security/getting_started"
    tag: "Documentation"
    text: "Getting Started with CWS"
---

Workload Security profiles provide a baseline of expected workload activity via a behavioral learning model that helps identify potential threats or misconfigurations. This insight can be used when investigating security alerts, including generating suppression suggestions for any known, acceptable workload behavior, as well as identifying previously unseen, anomalous behavior.

Workload Security profiles provide a baseline of expected workload activity via a behavioral learning model that helps identify potential threats or misconfigurations. Workload Security Profiles provide insight when investigating security alerts, and can generate suppression suggestions for any known, acceptable workload behavior.

## Compatibility

Workload Security Profiles are enabled by default.

For Workload Security Profiles to be compatible with your Datadog configuration, you must have [CWS enabled][1], and be using Datadog Agent 7.44 or later. Workload Security Profiles supports containerized workloads only.

## How Workload Security Profiles work

Workload Security Profiles are generated when [activity snapshots](#activity-snapshots) from containers sharing a common image name and image tag (version) are merged together to form a security profile.

Workload Security profiles are generated by merging activity snapshots collected by the agent and sent to the Datadog backend infrastructure.  For each agent, multiple containers on the host system are simultaneously profiled based on a configured threshold value, e.g. default value = 5, to minimize the performance overhead on the host system.  All kernel level activity is captured for a configured set of time, e.g. default value = 30 minutes, and arranged into an activity snapshot.

A different security profile is generated for each version of a container image, i.e. a service.  As a result, one profile is generated per { image-name, image-tag} tag combination.

Below is a high level representation of how activity snapshots that are captured from multiple containers will be merged into a single workload security profile with a commonality percentage calculated.

---

and container specific threat detection, Workload Security Profiles capture kernel-level activity on a per container basis for all running containers on the CWS monitored host systems. 


Workload Security Profiles are generated when activity from containers sharing a common image name and image tag (version) are merged together to form a security profile. The security profile acts as a behavior model for a given workload image to identify normal, expected behavior that is expected to be consistent across all containers versus previously unseen, anomalous behavior that may be unique to a single container or small number of containers. 

In addition to requiring containerized workloads, customers should deploy agent version 7.44+ which contains the latest Workload Security Profiles capabilities and will be enabled by default when CWS is enabled.  

### Activity snapshots

Activity snapshots are the building blocks of Workload Security Profiles. Each snapshot captures kernel-level activity on a container, including process, network, and file access 
details. This information is collected by the Agent in 30 minute intervals and sent to the Datadog backend.

Snapshots provide a reasonably accurate representation of expected workload behavior. This representation results in a more precise behavior model for a specific workload as more containers are profiled. The results are then merged together into a single security profile based on common image attributes.

### Behavior learning model


---

While initial snapshots are being captured and merged into the workload security profile, the profile will be listed in a learning state. Once a threshold has been reached in terms of the number of activity snapshots merged or amount of time elapsed since the first snapshot, the workload security profile status will transition to a **stable** state. These status changes for workload security profiles and evolving details of the workload security profile are described in more detail in the next section regarding the behavior learning model.

A workload security profile is a behavior model for a specific workload. By capturing and then comparing kernel-level activity from individual containers, the workload security profile represents a model of the aggregate workload behavior of similar containers. Since containerized workloads are expected to be immutable, there should be few variations between workloads that share common image and image version values. A workload security profile presents this behavior model in a visual representation of the process nodes along with the file, and network activity relationships. The profile visualization displays how consistent or ‘common’ these relationships are across the various containers that have been profiled. 

The benefits of the behavior modeling is to be able to quickly identify normal workload behavior that can be ignored or suppressed in security alerts vs. abnormal or anomalous behavior that is more likely to be indicative of a threat, specifically an attack or misconfiguration that could lead to an attack.  

For the behavior modeling and related threat assessment to be effective, new containers must be quickly and automatically identified as they are being spun up continuously in many cloud native environments.  Once the Datadog agent is configured for CWS, it will automatically start to learn the behavior of any new containers using the Linux kernel control groups or cgroups that 

Once your agent is configured with activity dump enabled, it will automatically start to learn any
running cgroups (even those already running when you start the agent).

## Explore security profiles

Security profiles generated by CWS are displayed on the [Security Profiles][2] page, grouped by image name. Click an image name to see the full list of security profiles associated with the image. Details shown for each security profile include the number of activity dumps that were merged to create the profile, the status of the machine learning model, and the date on which the profile was last updated.

{{< img src="security/cws/security_profiles/security-profiles-overview.png" alt="CWS Security Profiles page with auto-generated security profiles" width="100%">}}

Select a security profile to view its details page. Explore the processes that make up the security profile, view related security signals, containers tagged with the image name, and the activity dumps that were used to create the profile.

### Calculation Commonality Score

The **Behavior Commonality** score at the top of the page shows how common the activity is across all workload instances monitored. In general, the higher the commonality score, the more likely that a given process or file activity is normal, known behavior. Scores may fluctuate over time as more workloads are merged into the profile, or the composition of the individual workloads change over time.

{{< img src="security/cws/security_profiles/security-profile.png" alt="CWS security profile details page" width="100%">}}

Select a process node to view additional details on the side panel. This includes a commonality score for the process based on how common the files and requests in the process activity are across all workload instances monitored.

Security profile details also appear in the signal panel in the [Security Signals Explorer][3]. You can use this information to help distinguish between potential threats and normal workload behavior. If the security profile matches known workload behavior, a [suppression suggestion](#suppress-signals-based-on-suggestions) is displayed.

{{< img src="security/cws/security_profiles/signal-security-profile.png" alt="Cloud Workload Security security profile page" width="80%">}}

### Suppress signals based on suggestions

If a signal matches known workload behavior for a security profile, a suppression suggestion is displayed on the security signal side panel. You can view the corresponding security profile and the process triggering the signal before choosing whether to accept the suggestion.

To accept the suggestion, click **Suppress Signals**, then click **Add Suppression to Rule**. This creates a suppression query for the rule that excludes the process from triggering future security signals.

{{< img src="security/cws/security_profiles/suppression-suggestion.png" alt="The security signal panel showing a suppression suggestion" width="80%">}}

## Further Reading

{{< partial name="whats-next/whats-next.html" >}}

[1]: /security/cloud_workload_security/setup
[2]: https://app.datadoghq.com/security/workload/profiles
[3]: /security/explorer
[4]: /security/cloud_workload_security/getting_started